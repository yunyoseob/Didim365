# âœ¨ SpringBoot BEAN êµ¬ì„±ì›ë¦¬

- ì‘ì„±ì : ìœ¤ìš”ì„­ ì‚¬ì›

ğŸ« ê°•ì˜ ì†Œê°œ

```
ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ í•µì‹¬ ê¸°ëŠ¥ì„ ì½”ë“œë¡œ ì§ì ‘ êµ¬í˜„í•˜ë©´ì„œ ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ ë™ì‘ ì›ë¦¬ì™€ ìŠ¤í”„ë§ ë¶€íŠ¸ì— ì ìš©ëœ ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì˜ í™œìš©ë²•ì„ ìµíˆê²Œ ë˜ëŠ” ê°•ì˜
```

ğŸ“ ëª©ì°¨

```
4.  ìë™ êµ¬ì„± ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ë° ì¡°ê±´ë¶€ ìë™ êµ¬ì„±
    - 4-1. ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜
    - 4-2. ìë™ êµ¬ì„± ì •ë³´ íŒŒì¼ ë¶„ë¦¬ ë° 
            ì–´ë…¸í…Œì´ì…˜ ì ìš©
    - 4.3. @Configurationê³¼ 
            proxyBeanMethods
    - 4-4. @Conditionalê³¼ Condition

5. ì™¸ë¶€ ì„¤ì •ì„ ì´ìš©í•œ ìë™êµ¬ì„±
    - 5-1. ìë™ êµ¬ì„±ì— Environment  
            property ì ìš©
```


# 4. ìë™ êµ¬ì„± ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜

Spring Bootì˜ ì–´ë…¸í…Œì´ì…˜ í™œìš©ì— ì•ì„œì„œ ìŠ¤í”„ë§ì˜ ê¸°ë³¸ì ì¸ ì–´ë…¸í…Œì´ì…˜ì€ ì•„ë˜ì™€ ê°™ë‹¤.

![image](https://user-images.githubusercontent.com/81727895/236685165-31855dec-c59b-4731-8193-90f4ea32c61a.png)


## **4-1. ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜**

ì–´ë…¸í…Œì´ì…˜ì— ì ìš©í•œ ì–´ë…¸í…Œì´ì…˜ì„ ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì´ë¼ê³  í•œë‹¤.

### **4-1-1. ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ ì‚´í´ë³´ê¸°**

>  **SimpleHelloService.java**

```java
@Service
// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class SimpleHelloService implements HelloService{
   ...
}
```

**âœ”ï¸ @Service ì–´ë…¸í…Œì´ì…˜ êµ¬ì„± ë³´ê¸°**

```java
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Component
public @interface Service {
    @AliasFor(
        annotation = Component.class
    )
    String value() default "";
}
```

ì—¬ê¸°ì„œ, @ServicesëŠ” @Component ì–´ë…¸í…Œì´ì…˜ì˜ ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.


>  **HelloController.java**

```java
@RestController
// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class HelloController {
    ...
}
```

**âœ”ï¸ @RestController ì–´ë…¸í…Œì´ì…˜ êµ¬ì„± ë³´ê¸°**

```java
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Controller
@ResponseBody
public @interface RestController {
    @AliasFor(
        annotation = Controller.class
    )
    String value() default "";
}
```

HelloController í´ë˜ìŠ¤ ìœ„ì— ìˆëŠ” @RestControllerëŠ” @Controllerì™€ @ResponseBodyì˜ ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.


**âœ”ï¸ @Controller êµ¬ì„± ë³´ê¸°**

```java
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Component
public @interface Controller {
    @AliasFor(
        annotation = Component.class
    )
    String value() default "";
}
```

RestController @interfaceìœ„ì˜ ControllerëŠ” @Componentì˜ ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.

ì´ë¥¼ ê·¸ë¦¼ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

![image](https://user-images.githubusercontent.com/81727895/236685498-04595be5-6c5b-488d-a4d2-9e84191fe1e6.png)

**âœ”ï¸ Composed annotation(í•©ì„± ì• ë…¸í…Œì´ì…˜)**

ì´ë ‡ê²Œ ë©”íƒ€ ì• ë…¸í…Œì´ì…˜ì„ í•˜ë‚˜ ì´ìƒ ì ìš©í•´ì„œ ë§Œë“  ì• ë…¸í…Œì´ì…˜ì„ í•©ì„± ì• ë…¸í…Œì´ì…˜ì´ë¼ê³  í•œë‹¤.

í´ë˜ìŠ¤ë‚˜ ë©”ì„œë“œì— ë¶€ì—¬í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ ê°€ì§€ê³  ìˆëŠ” ëª¨ë“  ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì´ ì ìš©ë˜ì–´ ìˆëŠ” ê²ƒê³¼ ê°™ë‹¤.


**ğŸ¤” ê¸°ì¡´ì— ìˆëŠ” ì–´ë…¸í…Œì´ì…˜ë§Œ ì‚¬ìš©í•´ë„ ë  ê²ƒ ê°™ì€ë°, êµ³ì´ ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ”?**

```
1.  ê°œë°œìê°€ ì½”ë“œë¥¼ ì½ì„ ë•Œ, í•´ë‹¹ í´ë˜ìŠ¤ê°€ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ëŠ” ì§€ íŒŒì•…í•¨ê³¼ ë™ì‹œì— ì–´ë…¸í…Œì´ì…˜ì˜ ê¸°ëŠ¥ê³¼ ì—­í• ì— ëŒ€í•œ ì¶”ê°€ì ì¸ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤

2. ì–´ë…¸í…Œì´ì…˜ì— ìˆì–´ì„œ ë‹¤ë¥¸ ë¶€ê°€ì ì¸ ê¸°ëŠ¥ ë° íš¨ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆë‹¤.
```


### **4-1-2. ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ í™œìš© ì˜ˆì œ**

- HelloServiceTest.java

```java
package tobyspring.helloboot;

import org.junit.jupiter.api.Test;
...
import static org.assertj.core.api.Assertions.assertThat;

// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class HelloServiceTest {
    @Test
    void simpleHelloService(){
        System.out.println("==== simpleHelloService ====");
        SimpleHelloService helloService = new SimpleHelloService();

        String ret = helloService.sayHello("Test");
        assertThat(ret).isEqualTo("Simple HelloTest");
    }

    @Test
    void complexHelloService(){
        System.out.println("==== complexHelloService ====");
        ComplexHelloService helloService = new ComplexHelloService();

        String ret = helloService.sayHello("Test");
        assertThat(ret).isEqualTo("Complex HelloTest");
    }
}
```

- ì¶œë ¥ ê²°ê³¼(í…ŒìŠ¤íŠ¸ ì´ìƒ ì—†ìŒ)

```
==== simpleHelloService ====
==== complexHelloService ====
```

Test ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì¤Œìœ¼ë¡œì¨ Test ê¸°ëŠ¥ì„ì„ íŒŒì•…í•  ìˆ˜ ìˆìœ¼ë‚˜, ì–´ë–¤ í…ŒìŠ¤íŠ¸ì¸ì§€ ì•Œê¸° ìœ„í•´, ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì„ ë§Œë“ ë‹¤ê³  ê°€ì •í•˜ì.

ì´ ë•Œ, ì„ì˜ë¡œ UnitTestë¼ëŠ” ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì„ ë§Œë“¤ì–´ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.

```java
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD) 
@Test 
@interface UnitTest{}
/*
1. @Retentionê³¼ @Targetì€ ë°˜ë“œì‹œ ë¶™ì—¬ì¤˜ì•¼ í•˜ëŠ” í•„ìˆ˜ ì˜µì…˜ì´ë‹¤.
2. @Target({ElementType.ANNOTATION_TYPE, ElementType.METHOD})ìœ¼ë¡œ ì‘ì„±í•  ê²½ìš°, ë‹¤ë¥¸ ì–´ë…¸í…Œì´ì…˜ì´ 
   @UnitTest ì–´ë…¸í…Œì´ì…˜ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.
3. @Test ì–´ë…¸í…Œì´ì…˜ì´ ì—†ìœ¼ë©´, @UnitTestê°€ @Testì˜ ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì¸ì§€ ì•Œ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ë„£ì–´ì£¼ì–´ì•¼ í•œë‹¤.
*/

// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class HelloServiceTest {
    @UnitTest
    void simpleHelloService(){
        ...
    }

    @Test
    void complexHelloService(){
        ...
    }
}
```

## **4-2. ìë™ êµ¬ì„± ì •ë³´ íŒŒì¼ ë¶„ë¦¬ ë° ì–´ë…¸í…Œì´ì…˜ ì ìš©**

ì•ì„œ, í…ŒìŠ¤íŠ¸ ë¡œì§ì„ í†µí•´ ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì„ í™œìš©í•˜ëŠ” ì˜ˆì‹œë¥¼ ì‘ì„±í–ˆë‹¤ë©´, ì´ë²ˆì—ëŠ” ë©”íƒ€ ì• ë…¸í…Œì´ì…˜ì„ í†µí•´ ìë™ êµ¬ì„± ì •ë³´ë¥¼ ë¶„ë¦¬í•´ë³´ë„ë¡ í•œë‹¤.

### **4-2-1. ë©”íƒ€ ì• ë…¸í…Œì´ì…˜ ìƒì„±, Config í´ë˜ìŠ¤ ìƒì„±í•˜ê¸°**

- RwkSpringBootAnnotation ì• ë…¸í…Œì´ì…˜ ìƒì„±í•˜ê¸°

```java
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@Configuration
@ComponentScan
// ì‚¬ìš©ì ì •ì˜ ì–´ë…¸í…Œì´ì…˜
public @interface RwkSpringBootAnnotation {
}
```

@Configuration ì–´ë…¸í…Œì´ì…˜ê³¼ @ComponentScan ì–´ë…¸í…Œì´ì…˜ì˜ ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì„ ìƒì„±í•˜ì˜€ë‹¤.

@Configuration ì–´ë…¸í…Œì´ì…˜ì˜ ê²½ìš° @Bean ì–´ë…¸í…Œì´ì…˜ì´ í•„ìˆ˜ì¸ë°, ì´ë¥¼ Config í´ë˜ìŠ¤ì— ë¶„ë¦¬ì‹œí‚¤ë„ë¡ í•œë‹¤.

ì´ ë•Œ, Config.javaëŠ” ë³„ë„ë¡œ config íŒ¨í‚¤ì§€ ì•ˆì—ì„œ ìƒì„±í•œë‹¤.

- í˜„ì¬ íŒ¨í‚¤ì§€ êµ¬ì¡°

```
java
    ã„´ tobyspring
        ã„´ config
            ã„´ Config.java
        ã„´ helloboot
            ã„´ HelloBootApplication
            ã„´ @RwkSpringBootAnnotation
...
```

- Config.java

```java
...
// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class Config {
    @Bean
    public ServletWebServerFactory servletWebServerFactory(){
        System.out.println("======== ServletWebServerFactory register =========");
        return new TomcatServletWebServerFactory();
    }

    @Bean
    public DispatcherServlet dispatcherServlet(){
        System.out.println("======== DispatcherServlet register =========");
        return new DispatcherServlet();
    }
}
```

- ì¶œë ¥ ê²°ê³¼

êµ¬ì„±ê³¼ ê´€ë ¨ëœ Config.javaì™€ ê°™ì€ í´ë˜ìŠ¤ë“¤ì„ configë¼ëŠ” íŒ¨í‚¤ì§€ì— ë”°ë¡œ ë¶„ë¦¬í•œ ë’¤, ì‹¤í–‰ì‹œí‚¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë‚œë‹¤.

```
***************************
APPLICATION FAILED TO START
***************************
```

ì´ìœ ëŠ” HelloBootApplicationì— ìˆëŠ” @RwkSpringBootApplicationì˜ @ComponentScan ë²”ìœ„ë¥¼ ë²—ì–´ë‚«ê¸° ë•Œë¬¸ì´ë‹¤.

ì´ëŸ´ ê²½ìš°, @Import ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ êµ¬ì„±ì •ë³´ì— í•„ìš”í•œ Classë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë‹¤.

### **4-2-2. @Importë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ êµ¬ì„±ì •ë³´ì— ì¶”ê°€í•˜ê¸°**

```java
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@Configuration
@ComponentScan
@Import(Config.class)
// ì‚¬ìš©ì ì •ì˜ ì–´ë…¸í…Œì´ì…˜
public @interface RwkSpringBootAnnotation {
}
```
- ë‹¨, Importì— ë“¤ì–´ê°ˆ classëŠ” @Component ì–´ë…¸í…Œì´ì…˜ì´ ìˆëŠ” classê±°ë‚˜, @Componentì˜ ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì´ ìˆëŠ” classì—¬ì•¼ í•œë‹¤.

- ì¶œë ¥ ê²°ê³¼

```
...
======== ServletWebServerFactory register =========
...
======== DispatcherServlet register =========
...
```

@Import ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ êµ¬ì„±ì •ë³´ë¥¼ import í•œ ë’¤, ë‹¤ì‹œ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.


**ğŸ¤” Importí•´ì•¼í•  í´ë˜ìŠ¤ë“¤ì˜ ì¢…ë¥˜ê°€ ë§ì•„ì§ˆ ê²½ìš°, í•˜ë‚˜í•˜ë‚˜ @Import ì•ˆì— ì¶”ê°€í•˜ê¸° ë¶ˆí¸í•´ì§ˆí…ë° ì´ëŸ´ ê²½ìš°ì—ëŠ” ì–´ë–»ê²Œ í•´ì•¼ í•˜ë‚˜ìš”?**

ìŠ¤í”„ë§ì—ì„œ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ì˜ ê²½ìš°, @Import(í´ë˜ìŠ¤ì´ë¦„.class)ë¡œ ë“±ë¡í•˜ë©´ ë˜ì§€ë§Œ, ì‹¤ì œë¡œ ìŠ¤í”„ë§ì—ì„œ Importí•´ì•¼í•  í´ë˜ìŠ¤ê°€ ë§ì•„ì§ˆ ê²½ìš°, ìŠ¤í”„ë§ì— ìˆëŠ” ImportSelector ì¸í„°í˜ì´ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ì—¬ëŸ¬ ê°œë¥¼ import í•  ìˆ˜ ìˆë‹¤.


```java
public interface ImportSelector {
    String[] selectImports(AnnotationMetadata importingClassMetadata);

    @Nullable
    default Predicate<String> getExclusionFilter() {
        return null;
    }
}
```

- ImportSelectorë¥¼ ìƒì†í•œ DeferredImportSelector ì¸í„°í˜ì´ìŠ¤

```java
public interface DeferredImportSelector extends ImportSelector
```


### **4-2-3. DeferredImportSelectorë¥¼ êµ¬í˜„í•˜ì—¬ selectImports ë©”ì„œë“œ ì‘ì„±í•˜ê¸°**

**1. RwkAutoConfiguration**

- Path From Source Root: tobyspring.config.RwkAutoConfiguration.java

```java
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@Configuration
// ì‚¬ìš©ì ì •ì˜ ì–´ë…¸í…Œì´ì…˜
public @interface RwkAutoConfiguration {
}
```

ë¨¼ì €, @Configurationì˜ ë©”íƒ€ ì–´ë…¸í…Œì´ì…˜ì„ ìƒì„±í•œë‹¤.


**2. tobyspinrg.config.RwkAutoConfiguration.imports**

- Path From Source Root: META-INF/spring/tobyspinrg.config.RwkAutoConfiguration.imports

```
tobyspring.config.autoconfig.DispatcherServletConfig
tobyspring.config.autoconfig.TomcatWebServerConfig
```

imports íŒŒì¼ì„ ë§Œë“  ë’¤, Importí•  Classì˜ name spaceë¥¼ ì‘ì„±í•œë‹¤.

**3. AutoConfigImportSelector**

- Path From Source Root: tobyspring.config.AutoConfigImportSelector.java

```java
// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class AutoConfigImportSelector implements DeferredImportSelector{

    private final ClassLoader classLoader;

    public AutoConfigImportSelector(ClassLoader classLoader){
        this.classLoader=classLoader;
    }

    @Override
    public String[] selectImports(AnnotationMetadata importingClassMetadata) {
        // ImportCandidates::load -> imports íŒŒì¼ì— ìˆëŠ” í´ë˜ìŠ¤ë“¤ì„ í´ë˜ìŠ¤ ë¡œë”ë¡œ ì½ì–´ì„œ Iterableì— ì €ì¥
        Iterable<String> candidates =ImportCandidates.load(RwkAutoConfiguration.class, classLoader);
        // new í‚¤ì›Œë“œë¡œ ì¸ìŠ¤í„´ìŠ¤ 
        return StreamSupport.stream(candidates.spliterator(), false).toArray(String[]::new);
    }
}
```

ImportSelectorë¥¼ ìƒì†í•œ DeferredImportSelector ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ í´ë˜ìŠ¤ë“¤ì„ ì½ì€ ë’¤, ì¸ìŠ¤í„´ìŠ¤ í•œë‹¤.

**4. RwkSpringBootAnnotation**

- Path From Source Root: tobyspring.helloboot.RwkSpringBootAnnotation.java

```java
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@Configuration
@ComponentScan
@Import(AutoConfigImportSelector.class)
// ì‚¬ìš©ì ì •ì˜ ì–´ë…¸í…Œì´ì…˜
public @interface RwkSpringBootAnnotation {
}
```

ì´ì œ, helloboot íŒ¨í‚¤ì§€ ì•ˆì— ìˆëŠ” RwkSpringBootAnnotation ì–´ë…¸í…Œì´ì…˜ì— @Import ì•ˆì— AutoConfigImportSelector.classë¥¼ import í•´ì¤€ë‹¤.

- ì¶œë ¥ ê²°ê³¼

```
...
======== ServletWebServerFactory register =========
...
======== DispatcherServlet register =========
...
```

## **4.3. @Configurationê³¼ proxyBeanMethods**

- 01.SpringBoot WEB ë™ì‘ì›ë¦¬ì—ì„œ ì‹±ê¸€í†¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ëŒ€í•´ ì–¸ê¸‰í•œ ë‚´ìš© ë‹¤ì‹œ ë³´ê¸°

> ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ì‹±ê¸€í†¤ íŒ¨í„´ê³¼ ìœ ì‚¬í•˜ê²Œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë™ì‘í•˜ëŠ” ë™ì•ˆ ë”± **í•˜ë‚˜ì˜ ì˜¤ë¸Œì íŠ¸ë§Œ**ì„ ë§Œë“¤ê³  ì‚¬ìš©ë˜ê²Œ ë§Œë“¤ì–´ ì¤€ë‹¤. ì´ëŸ° ë©´ì—ì„œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” **ì‹±ê¸€í†¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬**ë¼ê³  í•œë‹¤.


**ğŸ¤” ìŠ¤í”„ë§ì€ ì™œ ì‹±ê¸€í†¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ ê³ ì§‘í• ê¹Œ? ê·¸ë¦¬ê³  ì–´ë–»ê²Œ ì‹±ê¸€í†¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆëŠ” ê²ƒì¼ê¹Œ?**

1. ìŠ¤í”„ë§ì€ í•œ ê°œì˜ ì˜¤ë¸Œì íŠ¸ë§Œ ì‚¬ìš©í•˜ê²Œ ë˜ëŠ”ë°, ë§Œì•½ í•˜ë‚˜ì˜ ë¹ˆì„ ë‘ ê°œ ì´ìƒì˜ ë‹¤ë¥¸ ë¹ˆì—ì„œ ì˜ì¡´í•˜ê³  ìˆë‹¤ë©´ FactoryMethodë¥¼ í˜¸ì¶œí•  ë•Œë§ˆë‹¤, ìƒˆë¡œìš´ ë¹ˆì´ ë§Œë“¤ì–´ì§€ëŠ” ë¬¸ì œê°€ ìƒê¸´ë‹¤.

2. ìŠ¤í”„ë§ì€ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ @Configuration ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ í´ë˜ìŠ¤ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Proxyë¥¼ ë§Œë“¤ì–´ì„œ ì´ë¥¼ í•´ê²°í•´ì¤€ë‹¤

> âœ”ï¸ Proxy ê¸°ëŠ¥ êµ¬í˜„í•´ë³´ê¸°

```java
// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class ConfigurationTest{
    // Proxy ì˜ˆì‹œ
    static class MyConfigProxy extends MyConfig {
        private Common common;

        @Override
        Common common() {
        if (this.common == null) this.common = super.common();
             return this.common;
        }
    }

    @Configuration
    static class MyConfig{
        @Bean
        Common common(){
            return new Common();
        }
        // ... ì´í•˜ ìƒëµ
    }

    // ... ì´í•˜ ìƒëµ
}
```

MyConfigProxyë¼ëŠ” í´ë˜ìŠ¤ê°€ ì—†ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì€ ì½”ë“œê°€ ìˆì„ ë•Œ, new Common() ì½”ë“œê°€ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œ ë  ê²½ìš°, ê°ì²´ì˜ ê°’ì€ ë‹¤ë¥´ê²Œ ë‚˜ì˜¤ê²Œ ëœë‹¤.

í•˜ì§€ë§Œ MyConfigProxyë¥¼ í†µí•´, new Common() ì½”ë“œê°€ ë”± í•œ ë²ˆë§Œ ì‹¤í–‰í•˜ê²Œ ë§Œë“¤ì–´ì¤„ ìˆ˜ ìˆë‹¤.

@Configuration ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ í´ë˜ìŠ¤ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ proxyBeanMethodsê°€ trueë¡œ ì„¤ì •ë˜ì–´ ìˆì–´, proxyBeanMethodsë¥¼ í†µí•´ ì‹±ê¸€í†¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ ê³ ìˆ˜í•œë‹¤.


ê·¸ëŸ¬ë‚˜, proxyBeanMethodsë¥¼ falseë¡œ ë°”ê¾¼ë‹¤ë©´, @Configurationì´ ë¶™ì€ í´ë˜ìŠ¤ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡ í•  ë•Œ, Proxyë¥¼ ë§Œë“¤ì§€ ì•Šê³ , ìë°” ì½”ë“œ ê·¸ëŒ€ë¡œ ë™ì‘í•˜ê²Œ ë§Œë“¤ì–´ì¤„ ìˆ˜ ìˆë‹¤.


### **4.3.3. @Configuration(proxyBeanMethods = false)ë¡œ ì‹¤ì œ í™œìš© ì˜ˆì‹œ**

- @EnableScheduling
```java
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Import({SchedulingConfiguration.class})
@Documented
public @interface EnableScheduling {
}
```
- SchedulingConfiguration.class
```java
@Configuration(
    proxyBeanMethods = false
)
@Role(2)
public class SchedulingConfiguration {
    public SchedulingConfiguration() {
    }
    @Bean(
        name = {"org.springframework.context.annotation.internalScheduledAnnotationProcessor"}
    )
    @Role(2)
    public ScheduledAnnotationBeanPostProcessor scheduledAnnotationProcessor() {
        return new ScheduledAnnotationBeanPostProcessor();
    }
}
```

SchedulingConfiguration ì†ŒìŠ¤ ì½”ë“œë¥¼ ë³´ë©´, Beanì„ í•˜ë‚˜ ìƒì„±í•˜ëŠ” ì½”ë“œê°€ ìˆëŠ”ë°, 
í•´ë‹¹ Beanì€ ìƒì„±í•˜ëŠ” ë™ì•ˆì—, ë‹¤ë¥¸ ì˜¤ë¸Œì íŠ¸ë¥¼ ì˜ì¡´í•˜ê³  ìˆì§€ ì•Šë‹¤.

ì´ëŸ° ê²½ìš°, ë§¤ë²ˆ Proxyë¥¼ ë§Œë“¤ì–´ì„œ ì ìš©í•   í•„ìš”ê°€ ì—†ë‹¤ê³  íŒë‹¨í•˜ì—¬ proxyBeanMethodsë¥¼ falseë¡œ ì„¤ì •í•œ ì¼€ì´ìŠ¤ì´ë‹¤.

## **4.4. @Conditionalê³¼ Condition**

### **4-4-1. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë¹ˆ**

![image](https://user-images.githubusercontent.com/81727895/236690191-c6b9a131-9179-4cb9-9267-44e395b669b2.png)


**ìŠ¤í”„ë§ì€ ì‚¬ìš©ì êµ¬ì„±ì •ë³´ì™€ ìë™ êµ¬ì„±ì •ë³´ë¥¼ í†µí•´ í•„ìš”í•œ êµ¬ì„±ì •ë³´ë¥¼ ì½ì–´ì˜¨ë‹¤.** 

ë¹ˆ ì˜¤ë¸Œì íŠ¸ì™€ ì—­í• ê³¼ êµ¬ë¶„ì—ì„œ ë³´ì•˜ë“¯ì´, ìŠ¤í”„ë§ì€ ì‚¬ìš©ì êµ¬ì„±ì •ë³´(ComponentScan)ê³¼ ìë™ êµ¬ì„±ì •ë³´(AutoConfiguration)ì„ í†µí•´, í•„ìš”í•œ êµ¬ì„±ì •ë³´ë¥¼ ì½ì–´ì˜¨ë‹¤.

ì‹¤ì œë¡œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ì´ ì™¸ì—ë„ ë” ë§ì€ ë¹ˆì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•œë‹¤.

- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ë¹ˆ
```
1. ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ ë¹ˆ

ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê¸°ëŠ¥(ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§, ë„ë©”ì¸ ë¡œì§)ì„ ë‹´ê³  ìˆëŠ” ë¹ˆ

2. ì• í”Œë¦¬ì¼€ì´ì…˜ ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ë¹ˆ

ê¸°ìˆ ê³¼ ê´€ë ¨ëœ ê²ƒìœ¼ë¡œ ì§ì ‘ ì‘ì„±í•˜ì§€ ì•Šê³ , ì‚¬ìš©í•˜ê² ë‹¤ê³  ì‘ì„±í•œ ë¹ˆ êµ¬ì„±ì •ë³´

3. ì»¨í…Œì´ë„ˆ ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ë¹ˆ

ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìì‹  í˜¹ì€ ê¸°ëŠ¥ì„ í™•ì¥í•˜ë©´ì„œ ì¶”ê°€í•´ì˜¨ ê²ƒë“¤ì„ ë¹ˆìœ¼ë¡œ ë“±ë¡ì‹œì¼œì„œ ì‚¬ìš©
```

ìë™ êµ¬ì„±ì •ë³´ë¥¼ í†µí•´ í•„ìš”í•œ êµ¬ì„±ì •ë³´ë¥¼ ì½ì–´ì˜¤ëŠ” ê³¼ì •ì„ ì•Œì•„ë³´ê¸° ìœ„í•´ @AutoConfigurationì„ ë³´ë„ë¡ í•œë‹¤.

### **4-4-2. @AutoConfiguration**

@AutoConfiguration ì–´ë…¸í…Œì´ì…˜ì„ ë³´ë©´, proxyBeanMethodsê°€ falseë¡œ ì„¸íŒ…ë˜ì–´ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

```java
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Configuration(
    proxyBeanMethods = false
)
@AutoConfigureBefore
@AutoConfigureAfter
public @interface AutoConfiguration {
    // ìƒëµ...
}
```

@AutoConfiguration ì–´ë…¸í…Œì´ì…˜ì´ ì–´ë–»ê²Œ êµ¬ì„±ë˜ì–´ ìˆëŠ”ì§€, spring-boot-autoconfigure-2.7.11.jar ë‚´ë¶€ë¥¼ ë³´ë©´ ì•Œ ìˆ˜ ìˆë‹¤.

### **4.4.3. ë©”ì´ë¸ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ spring-boot-autoconfigure-2.7.11.jar ë‚´ë¶€ ëœ¯ì–´ë³´ê¸°**

1. org.springframework.boot.autoconfigure - @AutoConfiguration 

![image](https://user-images.githubusercontent.com/81727895/236834752-9f637ca0-6030-4994-917c-66dcbdf4746f.png)


2. META-INF/spring - org.springframework.boot.autoconfigure.AutoConfiguration.imports

![image](https://user-images.githubusercontent.com/81727895/236833868-a273c1a9-4ef7-4bf4-a5df-da8b44f99a68.png)

- org.springframework.boot.autoconfigure.AutoConfiguration.imports ì‚´í´ë³´ê¸°

![image](https://user-images.githubusercontent.com/81727895/236835561-690fc347-ad4c-4156-8c91-123baedce771.png)

org.springframework.boot.autoconfigure.AutoConfiguration.imports ì•ˆì—ëŠ” ì´ 144ê°œì˜ í´ë˜ìŠ¤ë“¤ì´ Autoconfigurationì´ Spring Bootì— ê¸°ë³¸ì ìœ¼ë¡œ ë“±ë¡ ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

> **ğŸ¤”  Application ì‹œì‘í•  ë•Œë§ˆë‹¤ 144ê°œì˜ Configuration classê°€ ë‹¤ ë¡œë”©ì´ ë˜ë©´ì„œ ì•ˆì— ìˆëŠ” ë¹ˆì„ ë‹¤ ë“±ë¡í• ê¹Œ?**

ê·¸ë ‡ê²Œ ëœë‹¤ë©´ ë§¤ìš° ë¹„íš¨ìœ¨ì ì¸ ë°©ì‹ì¼ ê²ƒì´ë‹¤.
ìŠ¤í”„ë§ì€ ì¡°ê±´ì— ë”°ë¼ ì»¨í…Œì´ë„ˆì— ë¹ˆìœ¼ë¡œ ë“±ë¡ì„ ê²°ì •í•œë‹¤.

ì´ ë•Œ, @Conditional ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ëª¨ë“  ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ê²½ìš°ì—ë§Œ ì»¨í…Œì´ë„ˆì— ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.

### **4.4.4. @Conditionialì„ í†µí•´ ì¡°ê±´ì— ë”°ë¼ Tomcatê³¼ Jetty ì„œë²„ ë„ìš°ê¸°**

**âœ”ï¸ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆ ê¸°ìˆ  êµ¬í˜„ ë¼ì´ë¸ŒëŸ¬ë¦¬**

1. Tomcatì€ ìë°”ì˜ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆë¥¼ ê¸°ìˆ ì„ êµ¬í˜„í•œ êµ¬í˜„ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¤‘ í•˜ë‚˜ì´ë‹¤.

2. ìŠ¤í”„ë§ë¶€íŠ¸ëŠ” Tomcat, Jetty, Undertow ì„¸ ê°€ì§€ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆë¥¼ standaloneìœ¼ë¡œ ë™ì‘í•˜ëŠ” ìŠ¤í”„ë§ ë¶€íŠ¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„ë² ë””ë“œ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.

@Conditional ì¡°ê±´ìœ¼ë¡œ Tomcat ì„œë²„ë¥¼ ì“¸ì§€, ë‹¤ë¥¸ ì¢…ë¥˜ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆ(Jetty, Undertow) ì¤‘ Jetty ì“¸ì§€ ê²°ì •í•˜ëŠ” ë¡œì§ì„ ì‘ì„±í•´ë³´ë„ë¡ í•œë‹¤.

- pom.xml

```
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-starter-jetty</artifactId>
</dependency>
```

dependencyì— jettyë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.

- JettyWebServerConfig

```java
@RwkAutoConfiguration
// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class JettyWebServerConfig {
    @Bean("jettyWebServerFactory")
    public ServletWebServerFactory servletWebServerFactory(){
        return new JettyServletWebServerFactory();
    }
}
```

ê¸°ì¡´ì— ìˆë˜ TomcatWebServerConfig í´ë˜ìŠ¤ì˜ ê²½ìš° @Beanì„ @Bean("tomcatWebServerFactory")ìœ¼ë¡œ ë°”ê¾¸ì–´ ì¤€ë‹¤.

- tobyspring.config.RwkAutoConfiguration.imports

```
tobyspring.config.autoconfig.DispatcherServletConfig
tobyspring.config.autoconfig.TomcatWebServerConfig
tobyspring.config.autoconfig.JettyWebServerConfig
```

ë§ˆì§€ë§‰ìœ¼ë¡œ, tobyspring.config.RwkAutoConfiguration.importsì— tobyspring.config.autoconfig.JettyWebServerConfigë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.

**ğŸ¤” ìŠ¤í”„ë§ë¶€íŠ¸ë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ Jetty ì„œë²„ê°€ ëœ°ê¹Œ? Tomcat ì„œë²„ê°€ ëœ°ê¹Œ?**

```
...
Unable to start ServletWebServerApplicationContext due to multiple ServletWebServerFactory beans : tomcatWebServerFactory,jettyWebServerFactory
...
```

ì„œë²„ë¥¼ ì‹¤í–‰í•˜ë©´, multiple ServletWebServerFactory beansì´ ì¡´ì¬í•˜ì—¬ ì„ íƒí•  ìˆ˜ ì—†ì–´ì„œ ì—ëŸ¬ê°€ ë‚œë‹¤.

**âœ”ï¸ @Conditionalê³¼ Condition ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬ Tomcatê³¼ Jettyì¤‘ ì„ íƒí•˜ì—¬ ë¹ˆ ë“±ë¡í•˜ê¸°**

- TomcatWebServerConfig

```java
@Configuration
@Conditional(TomcatWebServerConfig.TomcatCondition.class)
// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class TomcatWebServerConfig {
    @Bean("tomcatWebServerFactory")
    public ServletWebServerFactory servletWebServerFactory(){
        return new TomcatServletWebServerFactory();
    }
    // ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
    static class TomcatCondition implements Condition {
        @Override
        public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
            return false;
        }
    }
}
```

- JettyWebServerConfig

```java
@RwkAutoConfiguration
@Conditional(JettyWebServerConfig.JettyCondition.class)
// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class JettyWebServerConfig {
    @Bean("jettyWebServerFactory")
    public ServletWebServerFactory servletWebServerFactory(){
        return new JettyServletWebServerFactory();
    }

    // ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
    static class JettyCondition implements Condition {
        @Override
        public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
            return true;
        }
    }
}
```

@Conditionalê³¼ Conditionì„ êµ¬í˜„í•˜ì—¬ Jetty ì„œë²„ë§Œ ë„ìš°ê³ , Tomcat ì„œë²„ëŠ” ë„ìš°ì§€ ì•Šê²Œ í•œ ë‹¤ìŒ ì‹¤í–‰í•˜ë©´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•œë‹¤.

- HelloBootApplication ì‹¤í–‰ ê²°ê³¼

![image](https://user-images.githubusercontent.com/81727895/236852344-d6fbade1-f2a6-4e09-ad78-f2bef52ec4d6.png)


ì´ë²ˆì—ëŠ” ë°˜ëŒ€ë¡œ TomcatConditioní´ë˜ìŠ¤ì˜ matches ë©”ì„œë“œì˜ ë¦¬í„´ê°’ì„ trueë¡œ ì§€ì •í•˜ê³ ,
JettyCondition í´ë˜ìŠ¤ì˜ matches ë©”ì„œë“œì˜ ë¦¬í„´ê°’ì„ falseë¡œ ì§€ì •í•˜ì, Tomcat ì„œë²„ë§Œ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•œë‹¤.

![image](https://user-images.githubusercontent.com/81727895/236852926-18989d79-8a77-4dce-b5ed-712ac861a993.png)


**âœ”ï¸ ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ @Conditionalì€ Class Conditions, Bean Conditions ë“±
ë‹¤ì–‘í•œ ì¡°ê±´ìœ¼ë¡œ matchesí•˜ì—¬ ì²´í¬ í•  ìˆ˜ ìˆë‹¤.**


![image](https://user-images.githubusercontent.com/81727895/236865356-0fd26569-7651-4325-9178-8fb161668151.png)

![image](https://user-images.githubusercontent.com/81727895/236865393-2e1043b1-4c05-4154-8a94-ea58e270c9d7.png)

![image](https://user-images.githubusercontent.com/81727895/236865535-16e707ec-1850-420f-bac5-e92a5a761fa4.png)

# 5. ì™¸ë¶€ ì„¤ì •ì„ ì´ìš©í•œ ìë™êµ¬ì„±

ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ë³´ë©´ application.properties, common.properties ë“±ì˜ ì™¸ë¶€ í™˜ê²½ ì„¤ì • íŒŒì¼ë“¤ì„ í”íˆ ë³´ê²Œ ëœë‹¤.

Spring BootëŠ” ìë™ êµ¬ì„±ì— ë”°ë¥¸ Environment í”„ë¡œí¼í‹°ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤.

## 5-1. ìë™ êµ¬ì„±ì— Environment property ì ìš©

### **5.1.1. ApplicationRunner** 

- ApplicationRunner 

```java
package org.springframework.boot;

@FunctionalInterface
public interface ApplicationRunner {
    void run(ApplicationArguments args) throws Exception;
}
```

1. ApplicationRunner í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ë¹ˆì„ ë“±ë¡í•˜ë©´, ëª¨ë“  ìŠ¤í”„ë§ ë¶€íŠ¸ ì´ˆê¸°í™” ì‘ì—…ì´ ëë‚œ ë‹¤ìŒì—, ApplicationRunnerë¥¼ êµ¬í˜„í•œ ì˜¤ë¸Œì íŠ¸ë¥¼ runë©”ì„œë“œë¥¼ í†µí•´ ì‹¤í–‰í•´ì¤€ë‹¤.

2. Applicationì„ ì‹¤í–‰í•  ë•Œ, ì¸ìê°’ìœ¼ë¡œ ë°›ì€ ì •ë³´ë„ í•¨ê»˜ ë°›ì„ ìˆ˜ ìˆë‹¤.

3. ApplicationRunnerë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ê°€ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ê¸° ë•Œë¬¸ì—, ê·¸ ìì²´ë¡œ DIë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.

### **5.1.2. ApplicationRunnerë¡œ Environment ê°’ ë°›ì•„ì˜¤ê¸°**

- HelloBootApplication

```java
@RwkSpringBootAnnotation
// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class HelloBootApplication{
    @Bean
    ApplicationRunner applicationRunner(Environment env){
        return args -> {
            String name = env.getProperty("my.name");
            System.out.println("my.name : "+name);
        };
    }

    public static void main(String[] args){
        SpringApplication.run(HelloBootApplication.class, args);
    }
}
```

- application.properties

```properties
my.name=ApplicationProperties
```

- ì¶œë ¥ ê²°ê³¼

```
my.name : ApplicationProperties
```

### **5.1.2. Environment ìš°ì„  ìˆœìœ„ ì ìš©**

![image](https://user-images.githubusercontent.com/81727895/236867799-68f1f4ff-d1cc-41aa-a3c7-5b09efde41fb.png)

**âœ”ï¸ ìš°ì„  ìˆœìœ„ì— ìˆëŠ” ì˜ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¸íŒ…í•´ë³´ê¸°**

![image](https://user-images.githubusercontent.com/81727895/236872329-a177c409-3c4d-419f-a1cb-236f32ff2acb.png)


- ì¶œë ¥ ê²°ê³¼

```
my.name : EnvironmentVariable
```

ApplicationPropertiesì´ ì•„ë‹Œ EnvironmentVariableê°€ ì¶œë ¥ ë˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.


**âœ”ï¸ ìš°ì„  ìˆœìœ„ì— ìˆëŠ” System Environment Variablesì˜ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¸íŒ…í•´ë³´ê¸°**

![image](https://user-images.githubusercontent.com/81727895/236872736-90dfb446-fab7-40fe-8073-2ded9377d595.png)

- ì¶œë ¥ ê²°ê³¼

```
my.name : EnvironmentVariable
```

ApplicationPropertiesì´ ì•„ë‹Œ EnvironmentVariableê°€ ì¶œë ¥ ë˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.

### **5.1.3. Tomcatì‹¤í–‰ì‹œ, Environment contextPath ë°›ì€ ë’¤, í…ŒìŠ¤íŠ¸**

ì™¸ë¶€ ì„¤ì • ì •ë³´ë¥¼ ê°€ì ¸ì™€ì„œ Tomcatì˜ contextPathì— ì ìš©í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë³´ë„ë¡ í•˜ì.

- application.properties

```properties
contextPath=/hydrak-bh
```

- TomcatWebServerConfig

```java
@Configuration
@ConditionalRwkOnClass("org.apache.catalina.startup.Tomcat")
// ì‚¬ìš©ì ì •ì˜ í´ë˜ìŠ¤
public class TomcatWebServerConfig {
    /*
    *  @ConditionalOnMissingBean
    * ServletWebServerFactory Beanì´ ì‚¬ìš©ìê°€ ë“±ë¡í–ˆëŠ”ì§€ ì²´í¬í•˜ê³ 
    * ì—†ì„ ê²½ìš°, ë¹ˆìœ¼ë¡œ ë“±ë¡
    * */
    @Bean("tomcatWebServerFactory")
    @ConditionalOnMissingBean
    public ServletWebServerFactory servletWebServerFactory(Environment env){
        TomcatServletWebServerFactory factory = new TomcatServletWebServerFactory();
        factory.setContextPath(env.getProperty("contextPath"));
        return factory;
    }
}
```

- httpie í…ŒìŠ¤íŠ¸

![image](https://user-images.githubusercontent.com/81727895/236876522-215b3d24-8d23-4908-b7ce-04e99d83d2b8.png)

application.propertiesì˜ contextPathë¥¼ ê°€ì ¸ì™€ì„œ ì ìš©ê¹Œì§€ ì˜ ëœ ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.

## ìŠ¤í”„ë§ë¶€íŠ¸ ìì„¸íˆ ì‚´í´ë³´ê¸°

ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ ë™ì‘ ë°©ì‹ì„ ì´í•´í•˜ê³ , ìì‹ ì´ ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ ê³¼ ê´€ë ¨ëœ ìë™ êµ¬ì„±ê³¼ í”„ë¡œí¼í‹° ë“±ì„ ë¶„ì„í•˜ê³ , ì–´ë–»ê²Œ í™œìš©í•  ìˆ˜ ìˆëŠ”ì§€ íŒŒì•…í•˜ê¸° ìœ„í•´ì„œ **02.SpringBoot BEANêµ¬ì„±ì›ë¦¬**ë¥¼ í†µí•´ ë‹¤ì–‘í•œ ì‹¤ìŠµì„ í†µí•´ SpringBoot WEB ë™ì‘ ë°©ì‹ê³¼ BEANì˜ êµ¬ì„± ì›ë¦¬ì— ëŒ€í•´ ì•Œì•„ë³¼ ìˆ˜ ìˆì—ˆë‹¤.

![image](https://user-images.githubusercontent.com/81727895/236892531-9894b1d8-e29e-4707-a2a0-6586a57e6b6c.png)

ì‹¤ì œë¡œ ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ ë™ì‘ ë°©ì‹ì„ ë³´ë©´, Spring Bootê°€ ì‹œì‘í•˜ë©´ì„œ ìë™ êµ¬ì„± ëª©ë¡ì„ importí•˜ì—¬, Condition ì¡°ê±´ì— ë”°ë¼ ë§¤í•‘ì¡°ê±´ì„ íŒë³„í•˜ê³  .properties ì†ŒìŠ¤ì—ì„œ ì™¸ë¶€ì„¤ì • í”„ë¡œí¼í‹° ì ìš©ê¹Œì§€ ì•ì—ì„œ í•œ ë²ˆì”© ì‹¤ìŠµí–ˆë˜ ì½”ë“œë“¤ì´ ìŠ¤í”„ë§ë¶€íŠ¸ì— ë™ì‘ ë°©ì‹ì•ˆì— ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.

ì´ë²ˆ êµìœ¡ìë£Œë¥¼ í†µí•´ ìŠ¤í”„ë§ ë¶€íŠ¸(Spring boot)ê°€ ì–´ë–»ê²Œ **ìŠ¤í”„ë§ì„ ê¸°ë°˜**ìœ¼ë¡œ ì‹¤ë¬´ í™˜ê²½ì— ì‚¬ìš©ê°€ëŠ¥í•œ ìˆ˜ì¤€ì˜ **ë…ë¦½ì‹¤í–‰í˜• ì• í”Œë¦¬ì¼€ì´ì…˜**ì„ ë³µì¡í•œ ê³ ë¯¼ ì—†ì´ ë¹ ë¥´ê²Œ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ë„ì™€ì¤„ ìˆ˜ ìˆëŠ”ì§€ ìì„¸íˆ ì‚´í´ë³¼ ìˆ˜ ìˆì—ˆë‹¤.

**- ë -**






















